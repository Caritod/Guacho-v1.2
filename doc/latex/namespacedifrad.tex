\hypertarget{namespacedifrad}{}\section{difrad Module Reference}
\label{namespacedifrad}\index{difrad@{difrad}}


Ray tracing Radiative Trasnport.  


\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \hyperlink{namespacedifrad_a9bce19025195159710828548c95282dc}{init\+\_\+rand} ()
\begin{DoxyCompactList}\small\item\em initializes random number generation \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacedifrad_a1ccb144621689571d836f2f76c5fabae}{emdiff} (emax)
\begin{DoxyCompactList}\small\item\em calculates the diffuse fotoionization emissivity \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacedifrad_ac7efbacd89420f5c298f7fb666ba14f9}{random\+\_\+versor} (xd, yd, zd)
\begin{DoxyCompactList}\small\item\em returns the 3 components of a random versor \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacedifrad_a180fbbe2c9b0639cc33dd6ef57a61ec4}{starsource} (srad, x0, y0, z0, x, y, z, xd, yd, zd)
\begin{DoxyCompactList}\small\item\em Place photon packets at a \char`\"{}star\char`\"{} surface. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacedifrad_a39291c8aa2927c69ef6ca60f78c9b103}{photons} (xl0, yl0, zl0, xd, yd, zd, f)
\begin{DoxyCompactList}\small\item\em Photon trajectories. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacedifrad_afe6e9d2182e755ae483aeaa2c91f2710}{radbounds} ()
\begin{DoxyCompactList}\small\item\em follows the rays across M\+P\+I boundaries \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacedifrad_a17151a5334db41fd14315d454e883b8e}{progress} (j, tot)
\begin{DoxyCompactList}\small\item\em Progress bar. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacedifrad_aeec1cd3dae50e6946aadb42abef934ec}{diffuse\+\_\+rad} ()
\begin{DoxyCompactList}\small\item\em Diffuse radiation driver. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{namespacedifrad_a0062472e34b740c2c1cb5084d3284056}{}real, parameter \hyperlink{namespacedifrad_a0062472e34b740c2c1cb5084d3284056}{a0} =6.\+3e-\/18\label{namespacedifrad_a0062472e34b740c2c1cb5084d3284056}

\begin{DoxyCompactList}\small\item\em Fotoionization cross section. \end{DoxyCompactList}\item 
\hypertarget{namespacedifrad_aac6943b42d4dede95a3296bdc29c629a}{}integer, parameter \hyperlink{namespacedifrad_aac6943b42d4dede95a3296bdc29c629a}{nrays} =1000000\label{namespacedifrad_aac6943b42d4dede95a3296bdc29c629a}

\begin{DoxyCompactList}\small\item\em Number of rays. \end{DoxyCompactList}\item 
\hypertarget{namespacedifrad_ab532f1879434284f63aa97c79c305236}{}real, dimension(\+:,\+:,\+:), allocatable \hyperlink{namespacedifrad_ab532f1879434284f63aa97c79c305236}{ph}\label{namespacedifrad_ab532f1879434284f63aa97c79c305236}

\begin{DoxyCompactList}\small\item\em Photoionizing rate. \end{DoxyCompactList}\item 
\hypertarget{namespacedifrad_a7d908916fd1e050b9c5ba48771186d5b}{}real, dimension(\+:,\+:,\+:), allocatable \hyperlink{namespacedifrad_a7d908916fd1e050b9c5ba48771186d5b}{em}\label{namespacedifrad_a7d908916fd1e050b9c5ba48771186d5b}

\begin{DoxyCompactList}\small\item\em Photoionizing emissivity. \end{DoxyCompactList}\item 
\hypertarget{namespacedifrad_a3d6a043ec876c626f11238b6260a036a}{}real, dimension(\+:,\+:,\+:), allocatable \hyperlink{namespacedifrad_a3d6a043ec876c626f11238b6260a036a}{photl}\label{namespacedifrad_a3d6a043ec876c626f11238b6260a036a}

\begin{DoxyCompactList}\small\item\em Auxiliary buffer for M\+P\+I. \end{DoxyCompactList}\item 
\hypertarget{namespacedifrad_adf49e979d01582a3c0032f9bde3c4555}{}real, dimension(\+:,\+:,\+:), allocatable \hyperlink{namespacedifrad_adf49e979d01582a3c0032f9bde3c4555}{photr}\label{namespacedifrad_adf49e979d01582a3c0032f9bde3c4555}

\begin{DoxyCompactList}\small\item\em Auxiliary buffer for M\+P\+I. \end{DoxyCompactList}\item 
\hypertarget{namespacedifrad_a65e54816218f7e0acae4ffeaaf9523f6}{}real, dimension(\+:,\+:,\+:), allocatable \hyperlink{namespacedifrad_a65e54816218f7e0acae4ffeaaf9523f6}{photb}\label{namespacedifrad_a65e54816218f7e0acae4ffeaaf9523f6}

\begin{DoxyCompactList}\small\item\em Auxiliary buffer for M\+P\+I. \end{DoxyCompactList}\item 
\hypertarget{namespacedifrad_a28892e6d6f67cbcb8b65e79132cf959b}{}real, dimension(\+:,\+:,\+:), allocatable \hyperlink{namespacedifrad_a28892e6d6f67cbcb8b65e79132cf959b}{phott}\label{namespacedifrad_a28892e6d6f67cbcb8b65e79132cf959b}

\begin{DoxyCompactList}\small\item\em Auxiliary buffer for M\+P\+I. \end{DoxyCompactList}\item 
\hypertarget{namespacedifrad_a73a81002fda23212ff6d9d8b6d161f32}{}real, dimension(\+:,\+:,\+:), allocatable \hyperlink{namespacedifrad_a73a81002fda23212ff6d9d8b6d161f32}{photo}\label{namespacedifrad_a73a81002fda23212ff6d9d8b6d161f32}

\begin{DoxyCompactList}\small\item\em Auxiliary buffer for M\+P\+I. \end{DoxyCompactList}\item 
\hypertarget{namespacedifrad_afa84bdf37b43d72b3e3e3b3c6291807e}{}real, dimension(\+:,\+:,\+:), allocatable \hyperlink{namespacedifrad_afa84bdf37b43d72b3e3e3b3c6291807e}{photi}\label{namespacedifrad_afa84bdf37b43d72b3e3e3b3c6291807e}

\begin{DoxyCompactList}\small\item\em Auxiliary buffer for M\+P\+I. \end{DoxyCompactList}\item 
\hypertarget{namespacedifrad_a1d5243b742ea3504f1b6b09132417333}{}integer, dimension(6) \hyperlink{namespacedifrad_a1d5243b742ea3504f1b6b09132417333}{buffersize}\label{namespacedifrad_a1d5243b742ea3504f1b6b09132417333}

\begin{DoxyCompactList}\small\item\em Auxiliary buffer for M\+P\+I. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Ray tracing Radiative Trasnport 

\subsection{Function/\+Subroutine Documentation}
\hypertarget{namespacedifrad_aeec1cd3dae50e6946aadb42abef934ec}{}\index{difrad@{difrad}!diffuse\+\_\+rad@{diffuse\+\_\+rad}}
\index{diffuse\+\_\+rad@{diffuse\+\_\+rad}!difrad@{difrad}}
\subsubsection[{diffuse\+\_\+rad}]{\setlength{\rightskip}{0pt plus 5cm}subroutine difrad\+::diffuse\+\_\+rad (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacedifrad_aeec1cd3dae50e6946aadb42abef934ec}
Upper level wrapper to compute the diffuse photoionization rate 

Definition at line 655 of file difrad.\+f90.



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacedifrad_aeec1cd3dae50e6946aadb42abef934ec_cgraph}
\end{center}
\end{figure}


\hypertarget{namespacedifrad_a1ccb144621689571d836f2f76c5fabae}{}\index{difrad@{difrad}!emdiff@{emdiff}}
\index{emdiff@{emdiff}!difrad@{difrad}}
\subsubsection[{emdiff}]{\setlength{\rightskip}{0pt plus 5cm}subroutine difrad\+::emdiff (
\begin{DoxyParamCaption}
\item[{real, intent(out)}]{emax}
\end{DoxyParamCaption}
)}\label{namespacedifrad_a1ccb144621689571d836f2f76c5fabae}
calculates the diffuse fotoionization emissivity in the entire domain 
\begin{DoxyParams}{Parameters}
{\em real} & \mbox{[}out\mbox{]} emax \+: maximum emissivity in the entire grid \\
\hline
\end{DoxyParams}


Definition at line 98 of file difrad.\+f90.



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=293pt]{namespacedifrad_a1ccb144621689571d836f2f76c5fabae_cgraph}
\end{center}
\end{figure}


\hypertarget{namespacedifrad_a9bce19025195159710828548c95282dc}{}\index{difrad@{difrad}!init\+\_\+rand@{init\+\_\+rand}}
\index{init\+\_\+rand@{init\+\_\+rand}!difrad@{difrad}}
\subsubsection[{init\+\_\+rand}]{\setlength{\rightskip}{0pt plus 5cm}subroutine difrad\+::init\+\_\+rand (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacedifrad_a9bce19025195159710828548c95282dc}
initializes random number generation 

Definition at line 56 of file difrad.\+f90.

\hypertarget{namespacedifrad_a39291c8aa2927c69ef6ca60f78c9b103}{}\index{difrad@{difrad}!photons@{photons}}
\index{photons@{photons}!difrad@{difrad}}
\subsubsection[{photons}]{\setlength{\rightskip}{0pt plus 5cm}subroutine difrad\+::photons (
\begin{DoxyParamCaption}
\item[{real, intent(in)}]{xl0, }
\item[{real, intent(in)}]{yl0, }
\item[{real, intent(in)}]{zl0, }
\item[{real, intent(in)}]{xd, }
\item[{real, intent(in)}]{yd, }
\item[{real, intent(in)}]{zd, }
\item[{real, intent(inout)}]{f}
\end{DoxyParamCaption}
)}\label{namespacedifrad_a39291c8aa2927c69ef6ca60f78c9b103}
Launches a photon from cell (xc,yc,zc) in the (xd,yd,zd) direction, with f and ionizing photons, and updates the photoionizing rate 
\begin{DoxyParams}{Parameters}
{\em real} & \mbox{[}in\mbox{]} xl0 \+: Initial X position \\
\hline
{\em real} & \mbox{[}in\mbox{]} yl0 \+: Initial Y position \\
\hline
{\em real} & \mbox{[}in\mbox{]} zl0 \+: Initial Z position \\
\hline
{\em real} & \mbox{[}in\mbox{]} xd \+: Direction in X \\
\hline
{\em real} & \mbox{[}in\mbox{]} yd \+: Direction in Y \\
\hline
{\em real} & \mbox{[}in\mbox{]} zd \+: Direction in Z \\
\hline
{\em real} & \mbox{[}in\mbox{]} f \+: N\+Umber of photoionizong photons \\
\hline
\end{DoxyParams}


Definition at line 252 of file difrad.\+f90.

\hypertarget{namespacedifrad_a17151a5334db41fd14315d454e883b8e}{}\index{difrad@{difrad}!progress@{progress}}
\index{progress@{progress}!difrad@{difrad}}
\subsubsection[{progress}]{\setlength{\rightskip}{0pt plus 5cm}subroutine difrad\+::progress (
\begin{DoxyParamCaption}
\item[{integer(kind=4)}]{j, }
\item[{integer(kind=4), intent(in)}]{tot}
\end{DoxyParamCaption}
)}\label{namespacedifrad_a17151a5334db41fd14315d454e883b8e}
Progress bar (only tested with Fortran conmpiler) takes a number between 1 and tot 
\begin{DoxyParams}{Parameters}
{\em integer} & \mbox{[}in\mbox{]} j \+: current iteration \\
\hline
{\em integer} & \mbox{[}in\mbox{]} tot \+: total number of iterartions \\
\hline
\end{DoxyParams}


Definition at line 633 of file difrad.\+f90.

\hypertarget{namespacedifrad_afe6e9d2182e755ae483aeaa2c91f2710}{}\index{difrad@{difrad}!radbounds@{radbounds}}
\index{radbounds@{radbounds}!difrad@{difrad}}
\subsubsection[{radbounds}]{\setlength{\rightskip}{0pt plus 5cm}subroutine difrad\+::radbounds (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacedifrad_afe6e9d2182e755ae483aeaa2c91f2710}
follows the rays across M\+P\+I boundaries 

Definition at line 455 of file difrad.\+f90.



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=293pt]{namespacedifrad_afe6e9d2182e755ae483aeaa2c91f2710_cgraph}
\end{center}
\end{figure}


\hypertarget{namespacedifrad_ac7efbacd89420f5c298f7fb666ba14f9}{}\index{difrad@{difrad}!random\+\_\+versor@{random\+\_\+versor}}
\index{random\+\_\+versor@{random\+\_\+versor}!difrad@{difrad}}
\subsubsection[{random\+\_\+versor}]{\setlength{\rightskip}{0pt plus 5cm}subroutine difrad\+::random\+\_\+versor (
\begin{DoxyParamCaption}
\item[{real, intent(out)}]{xd, }
\item[{real, intent(out)}]{yd, }
\item[{real, intent(out)}]{zd}
\end{DoxyParamCaption}
)}\label{namespacedifrad_ac7efbacd89420f5c298f7fb666ba14f9}
returns the 3 components of a random versor (unit magnitude) 
\begin{DoxyParams}{Parameters}
{\em real} & \mbox{[}out\mbox{]} xd \+: x component \\
\hline
{\em real} & \mbox{[}out\mbox{]} yd \+: y component \\
\hline
{\em real} & \mbox{[}out\mbox{]} zd \+: z component \\
\hline
\end{DoxyParams}


Definition at line 149 of file difrad.\+f90.

\hypertarget{namespacedifrad_a180fbbe2c9b0639cc33dd6ef57a61ec4}{}\index{difrad@{difrad}!starsource@{starsource}}
\index{starsource@{starsource}!difrad@{difrad}}
\subsubsection[{starsource}]{\setlength{\rightskip}{0pt plus 5cm}subroutine difrad\+::starsource (
\begin{DoxyParamCaption}
\item[{real, intent(in)}]{srad, }
\item[{real, intent(in)}]{x0, }
\item[{real, intent(in)}]{y0, }
\item[{real, intent(in)}]{z0, }
\item[{real, intent(out)}]{x, }
\item[{real, intent(out)}]{y, }
\item[{real, intent(out)}]{z, }
\item[{real, intent(out)}]{xd, }
\item[{real, intent(out)}]{yd, }
\item[{real, intent(out)}]{zd}
\end{DoxyParamCaption}
)}\label{namespacedifrad_a180fbbe2c9b0639cc33dd6ef57a61ec4}
returns the random location and direction at a star surface, if the direction goes into the star, the direction is inverted 
\begin{DoxyParams}{Parameters}
{\em real} & \mbox{[}in\mbox{]} Srad \+: radius of the \char`\"{}star\char`\"{} \\
\hline
{\em real} & \mbox{[}in\mbox{]} x0 \+: X position of the center of the star \\
\hline
{\em real} & \mbox{[}in\mbox{]} y0 \+: Y position of the center of the star \\
\hline
{\em real} & \mbox{[}in\mbox{]} y0 \+: Z position of the center of the star \\
\hline
{\em real} & \mbox{[}out\mbox{]} x \+: random X position at the star surface \\
\hline
{\em real} & \mbox{[}out\mbox{]} y \+: random Y position at the star surface \\
\hline
{\em real} & \mbox{[}out\mbox{]} z \+: random Z position at the star surface \\
\hline
{\em real} & \mbox{[}out\mbox{]} xd \+: random X direction \\
\hline
{\em real} & \mbox{[}out\mbox{]} yd \+: random Y direction \\
\hline
{\em real} & \mbox{[}out\mbox{]} zd \+: random Z direction \\
\hline
\end{DoxyParams}


Definition at line 187 of file difrad.\+f90.

