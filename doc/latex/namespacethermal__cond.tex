\hypertarget{namespacethermal__cond}{}\section{thermal\+\_\+cond Module Reference}
\label{namespacethermal__cond}\index{thermal\+\_\+cond@{thermal\+\_\+cond}}


Adds thermal conducion.  


\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \hyperlink{namespacethermal__cond_ac611766519a4602033c83e3ed5ae3c00}{init\+\_\+thermal\+\_\+cond} ()
\begin{DoxyCompactList}\small\item\em Intializes Temperature array. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacethermal__cond_a074d4829b3477fa8003983819e77523d}{get\+\_\+dt\+\_\+cond} (dt)
\begin{DoxyCompactList}\small\item\em computes conduction timescale \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacethermal__cond_a5283f7a2b8b4a4226ce624fb49445f43}{progress} (j, tot)
\begin{DoxyCompactList}\small\item\em Progress bar. \end{DoxyCompactList}\item 
real function \hyperlink{namespacethermal__cond_ab3978fb62e485cf71d7c83e779e92615}{ksp} (T)
\begin{DoxyCompactList}\small\item\em Spitzer conductivity. \end{DoxyCompactList}\item 
real function \hyperlink{namespacethermal__cond_a8205274631d6cb4d36ffc0937aa88a74}{ksp\+\_\+parl} (xtemp)
\begin{DoxyCompactList}\small\item\em Spitzer parallel conductivity. \end{DoxyCompactList}\item 
real function \hyperlink{namespacethermal__cond_adfd8867a0fc7fe02a35a41000e36f9bf}{ksp\+\_\+perp} (xtemp, xdens, B2)
\begin{DoxyCompactList}\small\item\em Spitzer perpendicular conductivity. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacethermal__cond_abc5c4fc622aea2f85fc5a0c2fee333bc}{heatfluxes} ()
\begin{DoxyCompactList}\small\item\em Returns Heat Fluxes. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacethermal__cond_aab43551b6a0d4b5894c07b510e4571d7}{mhd\+\_\+heatfluxes} ()
\begin{DoxyCompactList}\small\item\em Returns Heat Fluxes with anisotropic thermal conduction. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacethermal__cond_a55e65df0c700580f8af0a090063d2e32}{thermal\+\_\+bounds} ()
\begin{DoxyCompactList}\small\item\em Exchanges ghost cells for energy only. \end{DoxyCompactList}\item 
real function \hyperlink{namespacethermal__cond_a535cc1746914d413d4978aeda7b8fc06}{superstep} (N, \hyperlink{namespacethermal__cond_a53b14d15ce11990f6453a335c81d1728}{snu})
\begin{DoxyCompactList}\small\item\em Length of superstep. \end{DoxyCompactList}\item 
real function \hyperlink{namespacethermal__cond_a782aaba01217281f2aa57dcc955fd294}{substep} (j, N, \hyperlink{namespacethermal__cond_a38896e6bbd3b053ca066e407e4b3817f}{nu})
\begin{DoxyCompactList}\small\item\em Size of substep j. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacethermal__cond_a4c74dc0fd6a165d0fea419b560943701}{st\+\_\+steps} (fs, Ns, fstep)
\begin{DoxyCompactList}\small\item\em Returns the number of Supersteps. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacethermal__cond_a4b579df47b3bf4622a3ab51f57aa436b}{thermal\+\_\+conduction} ()
\begin{DoxyCompactList}\small\item\em Upper level wrapper for thermal conduction. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{namespacethermal__cond_a37c3e000231baaaa4668f7c05f021ce0}{}real, parameter \hyperlink{namespacethermal__cond_a37c3e000231baaaa4668f7c05f021ce0}{ph} =0.\+4\label{namespacethermal__cond_a37c3e000231baaaa4668f7c05f021ce0}

\begin{DoxyCompactList}\small\item\em Parameter for the sturated regime in Mc\+Kee. \end{DoxyCompactList}\item 
\hypertarget{namespacethermal__cond_a38896e6bbd3b053ca066e407e4b3817f}{}real, parameter \hyperlink{namespacethermal__cond_a38896e6bbd3b053ca066e407e4b3817f}{nu} =0.\+01\label{namespacethermal__cond_a38896e6bbd3b053ca066e407e4b3817f}

\begin{DoxyCompactList}\small\item\em Super-\/stepping da\+M\+P\+I\+\_\+\+N\+Bg factor. \end{DoxyCompactList}\item 
\hypertarget{namespacethermal__cond_a53b14d15ce11990f6453a335c81d1728}{}real, parameter \hyperlink{namespacethermal__cond_a53b14d15ce11990f6453a335c81d1728}{snu} =sqrt(\hyperlink{namespacethermal__cond_a38896e6bbd3b053ca066e407e4b3817f}{nu})\label{namespacethermal__cond_a53b14d15ce11990f6453a335c81d1728}

\begin{DoxyCompactList}\small\item\em Sqrt of damping factor. \end{DoxyCompactList}\item 
\hypertarget{namespacethermal__cond_a5420f28be46174eb6852f14281ec7ace}{}integer, parameter \hyperlink{namespacethermal__cond_a5420f28be46174eb6852f14281ec7ace}{max\+\_\+iter} = 100\label{namespacethermal__cond_a5420f28be46174eb6852f14281ec7ace}

\begin{DoxyCompactList}\small\item\em Maximum number of iterations. \end{DoxyCompactList}\item 
\hypertarget{namespacethermal__cond_ae13a8d994e65b9e57ebb80e892c72aac}{}real, parameter \hyperlink{namespacethermal__cond_ae13a8d994e65b9e57ebb80e892c72aac}{tstep\+\_\+red\+\_\+factor} =0.\+25\label{namespacethermal__cond_ae13a8d994e65b9e57ebb80e892c72aac}

\begin{DoxyCompactList}\small\item\em timestep reduction factor for the conduction \end{DoxyCompactList}\item 
\hypertarget{namespacethermal__cond_a0d692500ab9d6becafcf89d733d3f76f}{}real \hyperlink{namespacethermal__cond_a0d692500ab9d6becafcf89d733d3f76f}{dt\+\_\+cond}\label{namespacethermal__cond_a0d692500ab9d6becafcf89d733d3f76f}

\begin{DoxyCompactList}\small\item\em conduction timestep \end{DoxyCompactList}\item 
\hypertarget{namespacethermal__cond_a03140c73c7461f1882cd286b3e378abc}{}integer \hyperlink{namespacethermal__cond_a03140c73c7461f1882cd286b3e378abc}{tc\+\_\+log}\label{namespacethermal__cond_a03140c73c7461f1882cd286b3e378abc}

\begin{DoxyCompactList}\small\item\em loical unit to write T\+C log \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Adds a thermal conduction term, affects both the primitive and conserved variables 

\subsection{Function/\+Subroutine Documentation}
\hypertarget{namespacethermal__cond_a074d4829b3477fa8003983819e77523d}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!get\+\_\+dt\+\_\+cond@{get\+\_\+dt\+\_\+cond}}
\index{get\+\_\+dt\+\_\+cond@{get\+\_\+dt\+\_\+cond}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{get\+\_\+dt\+\_\+cond}]{\setlength{\rightskip}{0pt plus 5cm}subroutine thermal\+\_\+cond\+::get\+\_\+dt\+\_\+cond (
\begin{DoxyParamCaption}
\item[{real, intent(out)}]{dt}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_a074d4829b3477fa8003983819e77523d}
computes conduction timescale (in seconds) 
\begin{DoxyParams}{Parameters}
{\em real} & \mbox{[}out\mbox{]} dt \+:\+: conduction timescale \\
\hline
\end{DoxyParams}


Definition at line 83 of file thermal\+\_\+cond.\+f90.



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=342pt]{namespacethermal__cond_a074d4829b3477fa8003983819e77523d_cgraph}
\end{center}
\end{figure}


\hypertarget{namespacethermal__cond_abc5c4fc622aea2f85fc5a0c2fee333bc}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!heatfluxes@{heatfluxes}}
\index{heatfluxes@{heatfluxes}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{heatfluxes}]{\setlength{\rightskip}{0pt plus 5cm}subroutine thermal\+\_\+cond\+::heatfluxes (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_abc5c4fc622aea2f85fc5a0c2fee333bc}
Heat flux, if saturation enabled it takes minimum of the Spitzer and the saturated value ~\newline
 The result is stored in the 5th component of global the F,G,H fluxes (in cgs, conversion is done in dt product) 

Definition at line 194 of file thermal\+\_\+cond.\+f90.



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=334pt]{namespacethermal__cond_abc5c4fc622aea2f85fc5a0c2fee333bc_cgraph}
\end{center}
\end{figure}


\hypertarget{namespacethermal__cond_ac611766519a4602033c83e3ed5ae3c00}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!init\+\_\+thermal\+\_\+cond@{init\+\_\+thermal\+\_\+cond}}
\index{init\+\_\+thermal\+\_\+cond@{init\+\_\+thermal\+\_\+cond}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{init\+\_\+thermal\+\_\+cond}]{\setlength{\rightskip}{0pt plus 5cm}subroutine thermal\+\_\+cond\+::init\+\_\+thermal\+\_\+cond (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_ac611766519a4602033c83e3ed5ae3c00}
Intializes Temperature array (to resolve dependencies it was moved to the globals module) 

Definition at line 55 of file thermal\+\_\+cond.\+f90.

\hypertarget{namespacethermal__cond_ab3978fb62e485cf71d7c83e779e92615}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!ksp@{ksp}}
\index{ksp@{ksp}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{ksp}]{\setlength{\rightskip}{0pt plus 5cm}real function thermal\+\_\+cond\+::ksp (
\begin{DoxyParamCaption}
\item[{real, intent(in)}]{T}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_ab3978fb62e485cf71d7c83e779e92615}
Computes the Spitzer conductivity 
\begin{DoxyParams}{Parameters}
{\em real} & \mbox{[}in\mbox{]} T \+: temperature \mbox{[}K\mbox{]} \\
\hline
\end{DoxyParams}


Definition at line 147 of file thermal\+\_\+cond.\+f90.

\hypertarget{namespacethermal__cond_a8205274631d6cb4d36ffc0937aa88a74}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!ksp\+\_\+parl@{ksp\+\_\+parl}}
\index{ksp\+\_\+parl@{ksp\+\_\+parl}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{ksp\+\_\+parl}]{\setlength{\rightskip}{0pt plus 5cm}real function thermal\+\_\+cond\+::ksp\+\_\+parl (
\begin{DoxyParamCaption}
\item[{real, intent(in)}]{xtemp}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_a8205274631d6cb4d36ffc0937aa88a74}
Computes the Spitzer conductivity parallel to B 
\begin{DoxyParams}{Parameters}
{\em real} & \mbox{[}in\mbox{]} T \+: temperature \mbox{[}K\mbox{]} \\
\hline
\end{DoxyParams}


Definition at line 162 of file thermal\+\_\+cond.\+f90.

\hypertarget{namespacethermal__cond_adfd8867a0fc7fe02a35a41000e36f9bf}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!ksp\+\_\+perp@{ksp\+\_\+perp}}
\index{ksp\+\_\+perp@{ksp\+\_\+perp}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{ksp\+\_\+perp}]{\setlength{\rightskip}{0pt plus 5cm}real function thermal\+\_\+cond\+::ksp\+\_\+perp (
\begin{DoxyParamCaption}
\item[{real, intent(in)}]{xtemp, }
\item[{real, intent(in)}]{xdens, }
\item[{real, intent(in)}]{B2}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_adfd8867a0fc7fe02a35a41000e36f9bf}
Computes the Spitzer conductivity perpendicular to B 
\begin{DoxyParams}{Parameters}
{\em real} & \mbox{[}in\mbox{]} T \+: temperature \mbox{[}K\mbox{]} \\
\hline
\end{DoxyParams}


Definition at line 177 of file thermal\+\_\+cond.\+f90.

\hypertarget{namespacethermal__cond_aab43551b6a0d4b5894c07b510e4571d7}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!mhd\+\_\+heatfluxes@{mhd\+\_\+heatfluxes}}
\index{mhd\+\_\+heatfluxes@{mhd\+\_\+heatfluxes}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{mhd\+\_\+heatfluxes}]{\setlength{\rightskip}{0pt plus 5cm}subroutine thermal\+\_\+cond\+::mhd\+\_\+heatfluxes (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_aab43551b6a0d4b5894c07b510e4571d7}
Heat flux, if sturation enabled takes minimum of the Spitzer and the saturated value ~\newline
 The result is stored in the 5th component of global the F,G,H fluxes (in cgs, conversion is done in dt product) 

Definition at line 285 of file thermal\+\_\+cond.\+f90.



Here is the call graph for this function\+:
% FIG 0


\hypertarget{namespacethermal__cond_a5283f7a2b8b4a4226ce624fb49445f43}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!progress@{progress}}
\index{progress@{progress}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{progress}]{\setlength{\rightskip}{0pt plus 5cm}subroutine thermal\+\_\+cond\+::progress (
\begin{DoxyParamCaption}
\item[{integer(kind=4)}]{j, }
\item[{integer(kind=4), intent(in)}]{tot}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_a5283f7a2b8b4a4226ce624fb49445f43}
Progress bar (only tested with intel Fortran conmpiler) takes a number between 1 and tot 
\begin{DoxyParams}{Parameters}
{\em integer} & \mbox{[}in\mbox{]} j \+: current iteration \\
\hline
{\em integer} & \mbox{[}in\mbox{]} tot \+: total number of iterartions \\
\hline
\end{DoxyParams}


Definition at line 125 of file thermal\+\_\+cond.\+f90.

\hypertarget{namespacethermal__cond_a4c74dc0fd6a165d0fea419b560943701}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!st\+\_\+steps@{st\+\_\+steps}}
\index{st\+\_\+steps@{st\+\_\+steps}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{st\+\_\+steps}]{\setlength{\rightskip}{0pt plus 5cm}subroutine thermal\+\_\+cond\+::st\+\_\+steps (
\begin{DoxyParamCaption}
\item[{real, intent(in)}]{fs, }
\item[{integer, intent(out)}]{Ns, }
\item[{real, intent(out)}]{fstep}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_a4c74dc0fd6a165d0fea419b560943701}
Returns the number of Supersteps 
\begin{DoxyParams}{Parameters}
{\em real} & fs \+: ratio of dtcond/dthydro \\
\hline
{\em integer} & Ns \+: Number of Supersteps \\
\hline
{\em real} & fstep \+: Number of supersteps (float) \\
\hline
\end{DoxyParams}


Definition at line 674 of file thermal\+\_\+cond.\+f90.



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=348pt]{namespacethermal__cond_a4c74dc0fd6a165d0fea419b560943701_cgraph}
\end{center}
\end{figure}


\hypertarget{namespacethermal__cond_a782aaba01217281f2aa57dcc955fd294}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!substep@{substep}}
\index{substep@{substep}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{substep}]{\setlength{\rightskip}{0pt plus 5cm}real function thermal\+\_\+cond\+::substep (
\begin{DoxyParamCaption}
\item[{integer, intent(in)}]{j, }
\item[{integer, intent(in)}]{N, }
\item[{real, intent(in)}]{nu}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_a782aaba01217281f2aa57dcc955fd294}
Returns the size of substep j of N 
\begin{DoxyParams}{Parameters}
{\em integer} & \mbox{[}in\mbox{]} j \+: index of current step \\
\hline
{\em integer} & \mbox{[}in\mbox{]} N \+: Total number of substeps \\
\hline
{\em real} & \mbox{[}in\mbox{]} nu \+: da\+M\+P\+I\+\_\+\+N\+Bg factor \\
\hline
\end{DoxyParams}


Definition at line 656 of file thermal\+\_\+cond.\+f90.

\hypertarget{namespacethermal__cond_a535cc1746914d413d4978aeda7b8fc06}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!superstep@{superstep}}
\index{superstep@{superstep}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{superstep}]{\setlength{\rightskip}{0pt plus 5cm}real function thermal\+\_\+cond\+::superstep (
\begin{DoxyParamCaption}
\item[{integer}]{N, }
\item[{real, intent(in)}]{snu}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_a535cc1746914d413d4978aeda7b8fc06}
Returns the length of the superstep with N inner substeps 
\begin{DoxyParams}{Parameters}
{\em integer} & \mbox{[}in\mbox{]} N \+: Nunber of inner substeps \\
\hline
{\em real} & \mbox{[}in\mbox{]} snu \+: sqrt of da\+M\+P\+I\+\_\+\+N\+Bg factor \\
\hline
\end{DoxyParams}


Definition at line 635 of file thermal\+\_\+cond.\+f90.

\hypertarget{namespacethermal__cond_a55e65df0c700580f8af0a090063d2e32}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!thermal\+\_\+bounds@{thermal\+\_\+bounds}}
\index{thermal\+\_\+bounds@{thermal\+\_\+bounds}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{thermal\+\_\+bounds}]{\setlength{\rightskip}{0pt plus 5cm}subroutine thermal\+\_\+cond\+::thermal\+\_\+bounds (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_a55e65df0c700580f8af0a090063d2e32}
Exchanges one layer of boundaries, only the equation that corresponds to the energy 

Definition at line 508 of file thermal\+\_\+cond.\+f90.

\hypertarget{namespacethermal__cond_a4b579df47b3bf4622a3ab51f57aa436b}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!thermal\+\_\+conduction@{thermal\+\_\+conduction}}
\index{thermal\+\_\+conduction@{thermal\+\_\+conduction}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{thermal\+\_\+conduction}]{\setlength{\rightskip}{0pt plus 5cm}subroutine thermal\+\_\+cond\+::thermal\+\_\+conduction (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_a4b579df47b3bf4622a3ab51f57aa436b}
This routine adds the heat conduction, receives the hydro timestep in seconds, and assumes the primitives and Temp(i,j,k) arrays are updated 

Definition at line 700 of file thermal\+\_\+cond.\+f90.



Here is the call graph for this function\+:
% FIG 1


