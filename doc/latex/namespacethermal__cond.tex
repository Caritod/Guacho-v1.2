\hypertarget{namespacethermal__cond}{}\section{thermal\+\_\+cond Module Reference}
\label{namespacethermal__cond}\index{thermal\+\_\+cond@{thermal\+\_\+cond}}


Adds (isotropuic) thermal conducion.  


\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \hyperlink{namespacethermal__cond_ac611766519a4602033c83e3ed5ae3c00}{init\+\_\+thermal\+\_\+cond} ()
\begin{DoxyCompactList}\small\item\em Intializes Temperature array. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacethermal__cond_a9e4afd71cbe737fe5189bc6ecbb3a61f}{dt\+\_\+cond} (dt)
\begin{DoxyCompactList}\small\item\em computes conduction timescale \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacethermal__cond_a5283f7a2b8b4a4226ce624fb49445f43}{progress} (j, tot)
\begin{DoxyCompactList}\small\item\em Progress bar. \end{DoxyCompactList}\item 
real function \hyperlink{namespacethermal__cond_ab3978fb62e485cf71d7c83e779e92615}{ksp} (T)
\begin{DoxyCompactList}\small\item\em Spitzer conductivity. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacethermal__cond_abc5c4fc622aea2f85fc5a0c2fee333bc}{heatfluxes} ()
\begin{DoxyCompactList}\small\item\em Returns Heat Fluxes. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacethermal__cond_a55e65df0c700580f8af0a090063d2e32}{thermal\+\_\+bounds} ()
\begin{DoxyCompactList}\small\item\em Exchanges ghost cells for energy only. \end{DoxyCompactList}\item 
real function \hyperlink{namespacethermal__cond_a535cc1746914d413d4978aeda7b8fc06}{superstep} (N, \hyperlink{namespacethermal__cond_a53b14d15ce11990f6453a335c81d1728}{snu})
\begin{DoxyCompactList}\small\item\em Length of superstep. \end{DoxyCompactList}\item 
real function \hyperlink{namespacethermal__cond_a782aaba01217281f2aa57dcc955fd294}{substep} (j, N, \hyperlink{namespacethermal__cond_a38896e6bbd3b053ca066e407e4b3817f}{nu})
\begin{DoxyCompactList}\small\item\em Size of substep j. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacethermal__cond_a4c74dc0fd6a165d0fea419b560943701}{st\+\_\+steps} (fs, Ns, fstep)
\begin{DoxyCompactList}\small\item\em Returns the number of Supersteps. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacethermal__cond_a685d70692ba68e1ebc0b5d6d8ee8e646}{thermal\+\_\+conduction} (dt)
\begin{DoxyCompactList}\small\item\em Upper level wrapper for thermal conduction. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{namespacethermal__cond_a37c3e000231baaaa4668f7c05f021ce0}{}real, parameter \hyperlink{namespacethermal__cond_a37c3e000231baaaa4668f7c05f021ce0}{ph} =0.\+4\label{namespacethermal__cond_a37c3e000231baaaa4668f7c05f021ce0}

\begin{DoxyCompactList}\small\item\em Parameter for the sturated regime in Mc\+Kee. \end{DoxyCompactList}\item 
\hypertarget{namespacethermal__cond_a38896e6bbd3b053ca066e407e4b3817f}{}real, parameter \hyperlink{namespacethermal__cond_a38896e6bbd3b053ca066e407e4b3817f}{nu} =0.\+005\label{namespacethermal__cond_a38896e6bbd3b053ca066e407e4b3817f}

\begin{DoxyCompactList}\small\item\em Super-\/stepping damping factor. \end{DoxyCompactList}\item 
\hypertarget{namespacethermal__cond_a53b14d15ce11990f6453a335c81d1728}{}real, parameter \hyperlink{namespacethermal__cond_a53b14d15ce11990f6453a335c81d1728}{snu} =sqrt(\hyperlink{namespacethermal__cond_a38896e6bbd3b053ca066e407e4b3817f}{nu})\label{namespacethermal__cond_a53b14d15ce11990f6453a335c81d1728}

\begin{DoxyCompactList}\small\item\em Sqrt of damping factor. \end{DoxyCompactList}\item 
\hypertarget{namespacethermal__cond_a35e92d8dd3107b43d3326f014577fa9e}{}real, dimension(\+:,\+:,\+:), allocatable \hyperlink{namespacethermal__cond_a35e92d8dd3107b43d3326f014577fa9e}{temp}\label{namespacethermal__cond_a35e92d8dd3107b43d3326f014577fa9e}

\begin{DoxyCompactList}\small\item\em Temperature array \mbox{[}K\mbox{]}. \end{DoxyCompactList}\item 
\hypertarget{namespacethermal__cond_a59c290133a4485e731bfc0185d006091}{}real \hyperlink{namespacethermal__cond_a59c290133a4485e731bfc0185d006091}{dtcond}\label{namespacethermal__cond_a59c290133a4485e731bfc0185d006091}

\begin{DoxyCompactList}\small\item\em conduction timestep \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Adds thermal conduction term, affects both the primitive and conserved variables 

\subsection{Function/\+Subroutine Documentation}
\hypertarget{namespacethermal__cond_a9e4afd71cbe737fe5189bc6ecbb3a61f}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!dt\+\_\+cond@{dt\+\_\+cond}}
\index{dt\+\_\+cond@{dt\+\_\+cond}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{dt\+\_\+cond}]{\setlength{\rightskip}{0pt plus 5cm}subroutine thermal\+\_\+cond\+::dt\+\_\+cond (
\begin{DoxyParamCaption}
\item[{real, intent(out)}]{dt}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_a9e4afd71cbe737fe5189bc6ecbb3a61f}
computes conduction timescale 
\begin{DoxyParams}{Parameters}
{\em real} & \mbox{[}out\mbox{]} dt \+:\+: conduction timescale \\
\hline
\end{DoxyParams}


Definition at line 62 of file thermal\+\_\+cond.\+f90.



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=332pt]{namespacethermal__cond_a9e4afd71cbe737fe5189bc6ecbb3a61f_cgraph}
\end{center}
\end{figure}


\hypertarget{namespacethermal__cond_abc5c4fc622aea2f85fc5a0c2fee333bc}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!heatfluxes@{heatfluxes}}
\index{heatfluxes@{heatfluxes}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{heatfluxes}]{\setlength{\rightskip}{0pt plus 5cm}subroutine thermal\+\_\+cond\+::heatfluxes (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_abc5c4fc622aea2f85fc5a0c2fee333bc}
Heat flux, takes minimum of spitzer and saturated value ~\newline
 The result is stored in the 5th component of global the F,G,H fluxes (in cgs, conversion is done in dt product) 

Definition at line 143 of file thermal\+\_\+cond.\+f90.



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=342pt]{namespacethermal__cond_abc5c4fc622aea2f85fc5a0c2fee333bc_cgraph}
\end{center}
\end{figure}


\hypertarget{namespacethermal__cond_ac611766519a4602033c83e3ed5ae3c00}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!init\+\_\+thermal\+\_\+cond@{init\+\_\+thermal\+\_\+cond}}
\index{init\+\_\+thermal\+\_\+cond@{init\+\_\+thermal\+\_\+cond}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{init\+\_\+thermal\+\_\+cond}]{\setlength{\rightskip}{0pt plus 5cm}subroutine thermal\+\_\+cond\+::init\+\_\+thermal\+\_\+cond (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_ac611766519a4602033c83e3ed5ae3c00}
Intializes Temperature array 

Definition at line 49 of file thermal\+\_\+cond.\+f90.

\hypertarget{namespacethermal__cond_ab3978fb62e485cf71d7c83e779e92615}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!ksp@{ksp}}
\index{ksp@{ksp}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{ksp}]{\setlength{\rightskip}{0pt plus 5cm}real function thermal\+\_\+cond\+::ksp (
\begin{DoxyParamCaption}
\item[{real, intent(in)}]{T}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_ab3978fb62e485cf71d7c83e779e92615}
Computes the Spitzer conductivity 
\begin{DoxyParams}{Parameters}
{\em real} & \mbox{[}in\mbox{]} T \+: temperature \mbox{[}K\mbox{]} \\
\hline
\end{DoxyParams}


Definition at line 127 of file thermal\+\_\+cond.\+f90.

\hypertarget{namespacethermal__cond_a5283f7a2b8b4a4226ce624fb49445f43}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!progress@{progress}}
\index{progress@{progress}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{progress}]{\setlength{\rightskip}{0pt plus 5cm}subroutine thermal\+\_\+cond\+::progress (
\begin{DoxyParamCaption}
\item[{integer(kind=4)}]{j, }
\item[{integer(kind=4), intent(in)}]{tot}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_a5283f7a2b8b4a4226ce624fb49445f43}
Progress bar (only tested with Fortran conmpiler) takes a number between 1 and tot 
\begin{DoxyParams}{Parameters}
{\em integer} & \mbox{[}in\mbox{]} j \+: current iteration \\
\hline
{\em integer} & \mbox{[}in\mbox{]} tot \+: total number of iterartions \\
\hline
\end{DoxyParams}


Definition at line 105 of file thermal\+\_\+cond.\+f90.

\hypertarget{namespacethermal__cond_a4c74dc0fd6a165d0fea419b560943701}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!st\+\_\+steps@{st\+\_\+steps}}
\index{st\+\_\+steps@{st\+\_\+steps}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{st\+\_\+steps}]{\setlength{\rightskip}{0pt plus 5cm}subroutine thermal\+\_\+cond\+::st\+\_\+steps (
\begin{DoxyParamCaption}
\item[{real, intent(in)}]{fs, }
\item[{integer, intent(out)}]{Ns, }
\item[{real, intent(out)}]{fstep}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_a4c74dc0fd6a165d0fea419b560943701}
Returns the number of Supersteps 
\begin{DoxyParams}{Parameters}
{\em real} & fs \+: ratio of dtcond/dthydro \\
\hline
{\em integer} & Ns \+: Number of Supersteps \\
\hline
{\em real} & fstep \+: Number of supersteps (float) \\
\hline
\end{DoxyParams}


Definition at line 382 of file thermal\+\_\+cond.\+f90.



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacethermal__cond_a4c74dc0fd6a165d0fea419b560943701_cgraph}
\end{center}
\end{figure}


\hypertarget{namespacethermal__cond_a782aaba01217281f2aa57dcc955fd294}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!substep@{substep}}
\index{substep@{substep}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{substep}]{\setlength{\rightskip}{0pt plus 5cm}real function thermal\+\_\+cond\+::substep (
\begin{DoxyParamCaption}
\item[{integer, intent(in)}]{j, }
\item[{integer, intent(in)}]{N, }
\item[{real, intent(in)}]{nu}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_a782aaba01217281f2aa57dcc955fd294}
Returns the size of substep j of N 
\begin{DoxyParams}{Parameters}
{\em integer} & \mbox{[}in\mbox{]} j \+: index of current step \\
\hline
{\em integer} & \mbox{[}in\mbox{]} N \+: Total number of substeps \\
\hline
{\em real} & \mbox{[}in\mbox{]} nu \+: damping factor \\
\hline
\end{DoxyParams}


Definition at line 364 of file thermal\+\_\+cond.\+f90.

\hypertarget{namespacethermal__cond_a535cc1746914d413d4978aeda7b8fc06}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!superstep@{superstep}}
\index{superstep@{superstep}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{superstep}]{\setlength{\rightskip}{0pt plus 5cm}real function thermal\+\_\+cond\+::superstep (
\begin{DoxyParamCaption}
\item[{integer}]{N, }
\item[{real, intent(in)}]{snu}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_a535cc1746914d413d4978aeda7b8fc06}
Returns the length of the superstep with N inner substeps 
\begin{DoxyParams}{Parameters}
{\em integer} & \mbox{[}in\mbox{]} N \+: Nunber of inner substeps \\
\hline
{\em real} & \mbox{[}in\mbox{]} snu \+: sqrt of damping factor \\
\hline
\end{DoxyParams}


Definition at line 343 of file thermal\+\_\+cond.\+f90.

\hypertarget{namespacethermal__cond_a55e65df0c700580f8af0a090063d2e32}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!thermal\+\_\+bounds@{thermal\+\_\+bounds}}
\index{thermal\+\_\+bounds@{thermal\+\_\+bounds}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{thermal\+\_\+bounds}]{\setlength{\rightskip}{0pt plus 5cm}subroutine thermal\+\_\+cond\+::thermal\+\_\+bounds (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_a55e65df0c700580f8af0a090063d2e32}
Exchanges one layer of boundaries, only the equation that corresponds to the energy 

Definition at line 216 of file thermal\+\_\+cond.\+f90.

\hypertarget{namespacethermal__cond_a685d70692ba68e1ebc0b5d6d8ee8e646}{}\index{thermal\+\_\+cond@{thermal\+\_\+cond}!thermal\+\_\+conduction@{thermal\+\_\+conduction}}
\index{thermal\+\_\+conduction@{thermal\+\_\+conduction}!thermal\+\_\+cond@{thermal\+\_\+cond}}
\subsubsection[{thermal\+\_\+conduction}]{\setlength{\rightskip}{0pt plus 5cm}subroutine thermal\+\_\+cond\+::thermal\+\_\+conduction (
\begin{DoxyParamCaption}
\item[{real, intent(in)}]{dt}
\end{DoxyParamCaption}
)}\label{namespacethermal__cond_a685d70692ba68e1ebc0b5d6d8ee8e646}
This routine adds the heat conduction, receives the hydro timestep in seconds, and assumes the primitives and Temp(i,j,k) arrays are updated 
\begin{DoxyParams}{Parameters}
{\em real} & \mbox{[}in\mbox{]} dt \+: Hysdrodynamical timestep (in seconds) \\
\hline
\end{DoxyParams}


Definition at line 408 of file thermal\+\_\+cond.\+f90.



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacethermal__cond_a685d70692ba68e1ebc0b5d6d8ee8e646_cgraph}
\end{center}
\end{figure}


